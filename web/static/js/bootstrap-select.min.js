!function(b){var a=function(f,c,g){if(g){g.stopPropagation();g.preventDefault()}this.$element=b(f);this.$newElement=null;var d=null;this.options=b.extend({},b.fn.selectpicker.defaults,this.$element.data(),typeof c=="object"&&c);this.style=this.options.style;this.size=this.options.size;this.init()};a.prototype={constructor:a,init:function(m){this.$element.hide();var d=this.$element.attr("class")!==undefined?this.$element.attr("class").split(/\s+/):"";var p=this.getTemplate();var c=this.$element.attr("id");p=this.createLi(p);this.$element.after(p);this.$newElement=this.$element.next(".bootstrap-select");var o=this.$newElement;var f=this.$newElement.find(".dropdown-menu");var l=this.$newElement.find(".dropdown-menu ul li > a");var n=parseInt(l.css("line-height"))+l.outerHeight();var h=this.$newElement.offset().top;var r=0;var g=0;var k=this.$newElement.outerHeight();button=this.$newElement.find("> button");if(c!==undefined){button.attr("id",c);b('label[for="'+c+'"]').click(function(){o.find("button#"+c).focus()})}for(var j=0;j<d.length;j++){if(d[j]!="selectpicker"){this.$newElement.addClass(d[j])}}button.addClass(this.style);this.checkDisabled();this.clickListener();this.$element.find("optgroup").each(function(){if(b(this).attr("label")){f.find(".opt"+b(this).index()).eq(0).before("<dt>"+b(this).attr("label")+"</dt>")}f.find(".opt"+b(this).index()).eq(0).parent().prev().addClass("optgroup-div")});if(this.size=="auto"){function q(){var e=h-b(window).scrollTop();var t=window.innerHeight;var i=parseInt(f.css("padding-top"))+parseInt(f.css("padding-bottom"))+parseInt(f.css("border-top-width"))+parseInt(f.css("border-bottom-width"))+parseInt(f.css("margin-top"))+parseInt(f.css("margin-bottom"))+2;var s=t-e-k-i;if(!o.hasClass("dropup")){r=Math.floor(s/n)}else{r=Math.floor((e-i)/n)}if(r<4){r=3}g=n*r;if(f.find("ul li").length+f.find("dt").length>r){f.find("ul").css({"max-height":g+"px","overflow-y":"scroll"})}else{f.find("ul").css({"max-height":"none","overflow-y":"auto"})}}q();b(window).resize(q);b(window).scroll(q)}else{if(this.size&&this.size!="auto"&&f.find("ul li").length>this.size){g=n*this.size;if(this.size==1){g=g+8}f.find("ul").css({"max-height":g+"px","overflow-y":"scroll"})}}this.$newElement.find("ul").bind("DOMNodeInserted",b.proxy(this.clickListener,this))},getTemplate:function(){var c="<div class='btn-group bootstrap-select'><button class='btn dropdown-toggle clearfix' data-toggle='dropdown'><span class='filter-option pull-left'>__SELECTED_OPTION</span>&nbsp;<span class='caret'></span></button><div class='dropdown-menu' role='menu'><ul>__ADD_LI</ul></div></div>";return c},createLi:function(f){var e=[];var k=[];var c="";var g=null;var j=this;var h=this.$element[0].selectedIndex?this.$element[0].selectedIndex:0;this.$element.find("option").each(function(){e.push(b(this).text())});this.$element.find("option").each(function(){if(b(this).parent().is("optgroup")){g=String(b(this).parent().index());var l=b(this).parent();for(var m=0;m<l.length;m++){k.push('<a class="opt'+g[m]+'" tabindex="-1" href="#">'+b(this).text()+"</a>")}}else{k.push('<a tabindex="-1" href="#">'+b(this).text()+"</a>")}});if(e.length>0){f=f.replace("__SELECTED_OPTION",e[h]);for(var d=0;d<e.length;d++){c+="<li rel="+d+">"+k[d]+"</li>"}}this.$element.find("option").eq(h).prop("selected",true);f=f.replace("__ADD_LI",c);return f},checkDisabled:function(){if(this.$element.is(":disabled")){button.addClass("disabled");button.click(function(c){c.preventDefault()})}},clickListener:function(){var c=this;b("body").on("touchstart.dropdown",".dropdown-menu",function(d){d.stopPropagation()});b(".dropdown-menu").find("li dt").on("click",function(d){d.stopPropagation()});this.$newElement.find("li a").on("click",function(i){i.preventDefault();var g=b(this).parent().index();var h=b(this).parent(),d=h.attr("rel"),f=h.parents(".bootstrap-select");if(c.$element.not(":disabled")){f.prev("select").find("option").eq(g).prop("selected",true);f.find(".filter-option").html(h.text());f.find("button").focus();f.prev("select").trigger("change")}});this.$element.on("change",function(f){var d=b(this).find("option:selected").text();b(this).next(".bootstrap-select").find(".filter-option").html(d)})}};b.fn.selectpicker=function(c,d){return this.each(function(){var g=b(this),f=g.data("selectpicker"),e=typeof c=="object"&&c;if(!f){g.data("selectpicker",(f=new a(this,e,d)))}if(typeof c=="string"){f[c]()}})};b.fn.selectpicker.defaults={style:null,size:"auto"}}(window.jQuery);
